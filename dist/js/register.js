"use strict";!function(){$("#ajax_top").load("modelhtml/top.html"),$("#ajax_header").load("modelhtml/header.html"),$("#ajax_footer").load("modelhtml/footer.html"),$(".r_agree").on("click","i,span",function(){$("#r_select").toggle()});var e=new GVerify({id:"codepic",type:"blend"});function o(){var t=$("#code").val();return e.validate(t)?($("#r_info").html(""),!0):($("#r_info").html("图形验证码错误"),!1)}$("#code").blur(function(){o()});var a=/^1[3-9]\d{9}$/,s=document.getElementById("userphone");s.onblur=function(){var t=s.value;if("获取验证码"==$("#getcode").val())return a.test(t)?void $.ajax({type:"post",url:"../api/register.php",data:{phone:t},success:function(t){"no"==t?($("#userphone").focus(),$("#r_info").html("该手机号已注册"),$("#getcode").attr("class",""),$("#userphone").attr("status","no")):($("#r_info").html(""),$("#getcode").attr("class","active"),$("#userphone").attr("status","yes"))}}):($("#r_info").html("请输入正确手机号"),$("#getcode").attr("class",""),!1);$("#getcode").attr("class","")};var r=null;function n(){var t=$("#r_password").val(),e=$("#r_password").val().length;return/\d/.test(t)&&/[a-zA-Z]/.test(t)&&5<e&&e<15?($("#r_info").html(""),!0):($("#r_info").html("密码由字母、数字或字符组成，长度6-15位。"),!1)}$("#getcode").click(function(){if($("#getcode").attr("class")){var t=new Promise(function(e){$.ajax({type:"post",url:"../api/duanxin.php",data:{userphone:$("#userphone").val()},success:function(t){e(t)}})});r=setInterval(function(){e--,$("#getcode").val(e+"s后重新获取"),$("#getcode").attr("class",""),0==e&&(clearInterval(r),$("#getcode").val("获取验证码"),a.test($("#userphone").val())&&$("#getcode").attr("class","active"))},1e3);var e=60;t.then(function(t){$("#register_btn").click(function(){"no"!=$("#userphone").attr("status")?$("#phonecode").val()==t?($("#userphone").attr("disabled",!0).css("background","#fdf7e9"),$("#r_info").html(""),o()&&n()&&("none"!=$("#r_select").css("display")?($("#r_info").html(""),$.ajax({type:"post",url:"../api/register.php",data:{phone:$("#userphone").val(),password:$("#r_password").val()},success:function(t){window.location.href="login.html",$("#code").val(""),$("#phonecode").val(""),alert("注册成功!")}})):$("#r_info").html("请同意注册协议"))):$("#r_info").html("手机验证码错误"):$("#r_info").html("该手机号已注册")})})}}),$("#r_password").blur(function(){n()}),$("#r_password").keyup(function(){$(this).val()?$("#eyes").css("display","block"):$("#eyes").css("display","none")}),$("#eyes").mousedown(function(){$("#eyes").attr("class","look"),$("#r_password").attr("type","text")}).mouseup(function(){$("#eyes").attr("class",""),$("#r_password").attr("type","password")})}();